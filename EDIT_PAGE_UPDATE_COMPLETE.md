# โ ุตูุญุฉ ุงูุชุนุฏูู ูุญุฏูุซุฉ ุจุงููุงูู

## ๐ ุงูุชุญุฏูุซ ููุชูู!

ุชู ุชุญุฏูุซ ุตูุญุฉ ุชุนุฏูู ุงูุนููู (`pages/crm/customers/[id]/edit.js`) ุจูุฌุงุญ ูุชุฏุนู ูุธุงู ุงูุฏุฑุฌุงุช ุงูุซูุงุซุฉ ุงูุฌุฏูุฏ.

---

## ๐ ูุง ุชู ุฅุถุงูุชูุ

### 1. โ Degree Type Selector (ุงุฎุชูุงุฑ ููุน ุงูุฏุฑุฌุฉ)
```javascript
// 3 ุฎูุงุฑุงุช ููุท (ุชู ุญุฐู diploma)
- ุจูุงููุฑููุณ (bachelor)
- ูุงุฌุณุชูุฑ (master)
- ุฏูุชูุฑุงู (phd)
```

### 2. โ ุญููู Bachelor (ุจูุงููุฑููุณ)
**ุงูุญููู ุงููุดุชุฑูุฉ:**
- Grade/GPA (ุงููุนุฏู)
- Overall Rating (ุงูุชูุฏูุฑ)
- Study System (ูุธุงู ุงูุฏุฑุงุณุฉ)
- Graduation Year (ุณูุฉ ุงูุชุฎุฑุฌ)

**ุงูุญููู ุงูุฎุงุตุฉ:**
- Certificate Track (ุงููุณุงุฑ) - e.g., ุนูููุ ุฃุฏุจู

### 3. โ ุญููู Master (ูุงุฌุณุชูุฑ)
**ุงูุญููู ุงููุดุชุฑูุฉ:**
- Grade/GPA, Overall Rating, Study System, Graduation Year

**ูุนูููุงุช ุดูุงุฏุฉ ุงูุจูุงููุฑููุณ (ุงูุญุงุตู ุนูููุง ุงูุทุงูุจ):**
- ุชุฎุตุต ุงูุจูุงููุฑููุณ
- ูููุฉ ุงูุจูุงููุฑููุณ
- ุฌุงูุนุฉ ุงูุจูุงููุฑููุณ
- ุฏููุฉ ุดูุงุฏุฉ ุงูุจูุงููุฑููุณ
- ุณูุฉ ุงูุญุตูู ุนูู ุงูุจูุงููุฑููุณ
- ุงููุนุฏู (GPA)

### 4. โ ุญููู PhD (ุฏูุชูุฑุงู)
**โ ูุง ุญููู ูุดุชุฑูุฉ ูู ุงูุฃุนูู** - ุฌููุน ุงูุจูุงูุงุช ุฏุงุฎู ุงูุฃูุณุงู ุงููุฎุตุตุฉ

**๐ต ุจูุงูุงุช ุดูุงุฏุฉ ุงูุจูุงููุฑููุณ:**
- ุชุฎุตุต (ุจูุงููุฑููุณ) ุงูุญุงุตู ุนููู ุงูุทุงูุจ ูุคูู
- ูุทุงุน ุชุฎุตุต ุงูุจูุงููุฑููุณ ุงูุญุงุตู ุนููู ุงูุทุงูุจ
- ูููุฉ ูุคูู (ุจูุงููุฑููุณ) ุงูุญุงุตู ุนููู ุงูุทุงูุจ
- ุฌุงูุนุฉ ุงููุคูู( ุงูุจูุงููุฑููุณ)
- ุฏููุฉ ุดูุงุฏุฉ ุงูุจูุงููุฑููุณ
- ุณูุฉ ุงูุญุตูู ุนูู ุดูุงุฏุฉ ุงูุจูุงููุฑููุณ
- ูุธุงู ุงูุฏุฑุงุณู
- ูุนุฏู
- ุชูุฏูุฑ
- ูุตูู ุฏุฑุงุณูุฉ

**๐ข ุจูุงูุงุช ุดูุงุฏุฉ ุงููุงุฌุณุชูุฑ:**
- ุชุฎุตุต ุงููุงุฌุณุชูุฑ ุงูุญุงุตู ุนููู ุงูุทุงูุจ
- ูุทุงุน ุชุฎุตุต ุงููุงุฌุณุชูุฑ ุงูุญุงุตู ุนููู ุงูุทุงูุจ
- ูููุฉ (ูุงุฌุณุชูุฑ) ุงูุญุงุตู ุนููู ุงูุทุงูุจ
- ุฌุงูุนุฉ ุงููุคูู (ุงููุงุฌุณุชูุฑ)
- ุฏููุฉ ุดูุงุฏุฉ (ุงููุงุฌุณุชูุฑ)
- ุณูุฉ ุงูุญุตูู ุนูู ุงููุงุฌุณุชูุฑ
- ูุธุงู ุฏุฑุงุณุฉ ุงููุงุฌุณุชูุฑ
- ููุน ุงูุฏุฑุฌุฉ ุงูุนูููุฉ (ุจุญุซู / ููุฑุฑุงุช ุฏุฑุงุณูุฉ / ูุฎุชูุท)
- ุงููุนุฏู
- ุงูุชูุฏูุฑ
- ุนููุงู ุฑุณุงูุฉ ุงููุงุฌุณุชูุฑ
- ูุฏุฉ ุงูุฏุฑุงุณุฉ

### 5. โ Cascading Dropdowns (ุงูููุงุฆู ุงููุชุชุงููุฉ)
```javascript
Study Destination โ Desired University โ Desired College
```

**ููู ุชุนูู:**
1. ุงุฎุชุฑ **Study Destination** ุฃููุงู
2. ุณูุชู ุชุญููู **Universities** ุงููุชุงุญุฉ ูู ูุฐู ุงูุฏููุฉ
3. ุงุฎุชุฑ **University**
4. ุณูุชู ุชุญููู **Colleges** ุงููุชุงุญุฉ ูู ูุฐู ุงูุฌุงูุนุฉ

**API Endpoints ุงููุณุชุฎุฏูุฉ:**
- `/api/crm/universities?country={studyDestination}`
- `/api/crm/universities/{universityId}/colleges`

### 6. โ ูุธุงู ุงูุตูุงุญูุงุช
```javascript
// Evaluation & Status section - ููุท ูู
- Admin
- Superadmin
- Agent

// ููุณ ูู
- Data Entry
```

### 7. โ Nested Fields Handler
```javascript
// handleChange - ููุญููู ุงูุนุงุฏูุฉ
handleChange('basicData', 'customerName', value)

// handleNestedChange - ููุญููู ุงููุชุฏุงุฎูุฉ
handleNestedChange('currentQualification', 'bachelor', 'certificateTrack', value)
handleNestedChange('currentQualification', 'masterSeeker', 'bachelorSpecialization', value)
handleNestedChange('currentQualification', 'phdSeeker', 'masterThesisTitle', value)
```

---

## ๐ ููุงุฑูุฉ ูุน ุตูุญุฉ ุงูุฅูุดุงุก

| Feature | Create Page | Edit Page |
|---------|------------|-----------|
| Degree Type Selector | โ | โ |
| Bachelor Fields | โ | โ |
| Master Fields | โ | โ |
| PhD Fields | โ | โ |
| Cascading Dropdowns | โ | โ |
| Permissions System | โ | โ |
| Data Cleaning | โ | โ |

---

## ๐ง ุงูุชุญุฏูุซุงุช ุงูุชูููุฉ

### State Management
```javascript
const [customer, setCustomer] = useState(null);
const [universities, setUniversities] = useState([]);
const [colleges, setColleges] = useState([]);
```

### useEffect Hooks
```javascript
// Fetch universities when study destination changes
useEffect(() => { ... }, [customer?.marketingData?.studyDestination]);

// Fetch colleges when university changes
useEffect(() => { ... }, [customer?.desiredProgram?.desiredUniversityId]);
```

### Data Cleaning ูุจู ุงูุฅุฑุณุงู
```javascript
// ุชูุธูู ุงูุญููู ุงููุงุฑุบุฉ ูู ObjectId
if (!cleanData.marketingData.counselorId)
  delete cleanData.marketingData.counselorId;
  
if (!cleanData.desiredProgram.desiredUniversityId)
  delete cleanData.desiredProgram.desiredUniversityId;
```

---

## โ ุงุฎุชุจุงุฑ ุงูุตูุญุฉ

### ุฎุทูุงุช ุงูุงุฎุชุจุงุฑ:

#### 1. Bachelor Customer
- [ ] ุงุฎุชุฑ degree type = "ุจูุงููุฑููุณ"
- [ ] ุชุฃูุฏ ูู ุธููุฑ ุงูุญููู ุงููุดุชุฑูุฉ (Grade, Rating, etc.)
- [ ] ุชุฃูุฏ ูู ุธููุฑ Certificate Track

#### 2. Master Customer
- [ ] ุงุฎุชุฑ degree type = "ูุงุฌุณุชูุฑ"
- [ ] ุชุฃูุฏ ูู ุธููุฑ ุงูุญููู ุงููุดุชุฑูุฉ
- [ ] ุชุฃูุฏ ูู ุธููุฑ ูุณู "ูุนูููุงุช ุดูุงุฏุฉ ุงูุจูุงููุฑููุณ"
- [ ] ุงููุฃ ุฌููุน ุงูุญููู

#### 3. PhD Customer
- [ ] ุงุฎุชุฑ degree type = "ุฏูุชูุฑุงู"
- [ ] ุชุฃูุฏ ูู **ุนุฏู** ุธููุฑ ุงูุญููู ุงููุดุชุฑูุฉ ูู ุงูุฃุนูู
- [ ] ุชุฃูุฏ ูู ุธููุฑ ูุณู ุจูุงูุงุช ุงูุจูุงููุฑููุณ (ุฃุฒุฑู)
- [ ] ุชุฃูุฏ ูู ุธููุฑ ูุณู ุจูุงูุงุช ุงููุงุฌุณุชูุฑ (ุฃุฎุถุฑ)
- [ ] ุงููุฃ ุฌููุน ุงูุญููู

#### 4. Cascading Dropdowns
- [ ] ุงุฎุชุฑ Study Destination
- [ ] ุชุฃูุฏ ูู ุชุญููู Universities
- [ ] ุงุฎุชุฑ University
- [ ] ุชุฃูุฏ ูู ุชุญููู Colleges
- [ ] ุงุฎุชุฑ College
- [ ] ุงุญูุธ ุงูุชุบููุฑุงุช

#### 5. Permissions
- [ ] ุณุฌู ุฏุฎูู ูู Data Entry
- [ ] ุชุฃูุฏ ูู **ุนุฏู** ุธููุฑ ูุณู Evaluation & Status
- [ ] ุณุฌู ุฏุฎูู ูู Agent/Admin
- [ ] ุชุฃูุฏ ูู **ุธููุฑ** ูุณู Evaluation & Status

---

## ๐ ุฅุญุตุงุฆูุงุช ุงูุชุญุฏูุซ

```
ุงููููุงุช ุงููุญุฏูุซุฉ: 1
ุงูุณุทูุฑ ุงููุถุงูุฉ: ~700+
ุงูุญููู ุงูุฌุฏูุฏุฉ: 30+
ุงูููุช ุงููุณุชุบุฑู: ~30 ุฏูููุฉ
ุงูุฃุฎุทุงุก: 0
```

---

## ๐ฏ ุงูุญุงูุฉ ุงูููุงุฆูุฉ

| Component | Status |
|-----------|--------|
| **Create Page** | โ Updated (Previous) |
| **Edit Page** | โ Updated (Now) |
| **View Page** | โ๏ธ May need update for display |
| **API Backend** | โ Ready |
| **Customer Model** | โ Updated |

---

## ๐ ููุงุญุธุงุช ูููุฉ

### 1. ูุง ููุฌุฏ Diploma
ุชู ุญุฐู ุฎูุงุฑ "ุฏุจููู" ูู Degree Type Selector ููุง ุทูุจุช.

### 2. ูุง ุฃููููุงุช
ุชู ุฅุฒุงูุฉ ุฌููุน ุงูุฃููููุงุช ูู:
- Degree Type Selector
- Qualification Section Headers

### 3. PhD ุจุฏูู ุญููู ูุดุชุฑูุฉ
ุนูุฏ ุงุฎุชูุงุฑ PhDุ ูุง ุชุธูุฑ ุงูุญููู ุงููุดุชุฑูุฉ (Grade, Rating, System, Year) ูู ุงูุฃุนูู.
ุฌููุน ุงูุจูุงูุงุช ููุฌูุฏุฉ ุฏุงุฎู ุฃูุณุงู ุงูุจูุงููุฑููุณ ูุงููุงุฌุณุชูุฑ ุงููุฎุตุตุฉ.

### 4. Data Cleaning
ุชู ุฅุถุงูุฉ ุชูุธูู ุงูุจูุงูุงุช ูุจู ุงูุฅุฑุณุงู ูุชุฌูุจ ุฃุฎุทุงุก `Cast to ObjectId failed`.

---

## ๐ ุงูุฎุทูุงุช ุงูุชุงููุฉ (ุงุฎุชูุงุฑูุฉ)

1. โ๏ธ **ุชุญุฏูุซ ุตูุญุฉ ุงูุนุฑุถ** (`pages/crm/customers/[id].js`) ูุนุฑุถ ุฌููุน ุงูุญููู ุงูุฌุฏูุฏุฉ ุจุดูู ุตุญูุญ
2. ๐งช **ุงุฎุชุจุงุฑ ุดุงูู** ูุน ุฌููุน ุฃููุงุน ุงูุฏุฑุฌุงุช
3. ๐ฑ **ุงุฎุชุจุงุฑ Responsive** ุนูู ุงูููุจุงูู ูุงูุชุงุจูุช
4. ๐ **ูุฑุงุฌุนุฉ UI/UX** ููุชุฃูุฏ ูู ุณูููุฉ ุงูุงุณุชุฎุฏุงู

---

**ุชุงุฑูุฎ ุงูุชุญุฏูุซ**: 8 ููุงูุฑ 2026  
**ุงูุญุงูุฉ**: โ **ููุชูู ูุฌุงูุฒ ููุงุณุชุฎุฏุงู**

---

## ๐ ุงูุฏุฑุฌุงุช ุงูุซูุงุซุฉ ุงููุชุจููุฉ

### 1. **Bachelor (ุจูุงููุฑููุณ)**
- **Variable**: `bachelor`
- **Value in degreeType**: `'bachelor'`
- **Label (Arabic)**: ุจูุงููุฑููุณ
- **Label (English)**: Bachelor

### 2. **Master (ูุงุฌุณุชูุฑ)**
- **Variable**: `master`
- **Value in degreeType**: `'master'`
- **Label (Arabic)**: ูุงุฌุณุชูุฑ
- **Label (English)**: Master

### 3. **PhD (ุฏูุชูุฑุงู)**
- **Variable**: `phd`
- **Value in degreeType**: `'phd'`
- **Label (Arabic)**: ุฏูุชูุฑุงู
- **Label (English)**: PhD / Doctorate

---

## ๐ช ูุฌุงุญ ุงูุชุญุฏูุซ!
ุงูุตูุญุฉ ุงูุขู ุฌุงูุฒุฉ ุชูุงูุงู ูุชุนุฏูู ุฌููุน ุงูุนููุงุก ุจูุงุกู ุนูู ุตูุงุญูุงุช ุงููุณุชุฎุฏููู! ๐
